<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Google’s Machine Learning Crash Course | Aditya Jaishankar</title>
<meta name="description" content="Definitions and Framing">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Aditya Jaishankar">
<meta property="og:title" content="Google’s Machine Learning Crash Course">
<meta property="og:url" content="http://localhost:4000/coursenotes/googlemachinelearning/">


  <meta property="og:description" content="Definitions and Framing">







  <meta property="article:published_time" content="2019-02-01T00:00:00-05:00">





  

  


<link rel="canonical" href="http://localhost:4000/coursenotes/googlemachinelearning/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Aditya Jaishankar",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Aditya Jaishankar Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->







<link href="https://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet">





<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/"> </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/coursework/" >Coursework</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/" >Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Blog</a>
            </li><li class="masthead__menu-item">
              <a href="/research/" >Ph.D. Research</a>
            </li><li class="masthead__menu-item">
              <a href="/publications/" >Publications</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/coursenotes" itemprop="item"><span itemprop="name">Coursenotes</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Google's Machine Learning Crash Course</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/bio-picture.jpg" alt="Aditya Jaishankar" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Aditya Jaishankar</h3>
    
    
      <p class="author__bio" itemprop="description">
        <b>Ph.D., Massachusetts Institute of Technology.</b><br>Soft Condensed Matter Physicist and Surface Scientist.
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">New Jersey, USA</span>
        </li>
      

      
        
          
        
          
            <li><a href="https://www.github.com/aditya-jaishankar/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/adityajaishankar" rel="nofollow noopener noreferrer"><i class="fab fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
          
        
          
            <li><a href="https://dspace.mit.edu/handle/1721.1/92159" rel="nofollow noopener noreferrer"><i class="fas fa-file-alt" aria-hidden="true"></i> Resume</a></li>
          
        
      

      

      
        <li>
          <a href="mailto:aditya1642@gmail.com">
            <meta itemprop="email" content="aditya1642@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Google’s Machine Learning Crash Course">
    <meta itemprop="description" content="Definitions and Framing">
    <meta itemprop="datePublished" content="February 01, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Google’s Machine Learning Crash Course
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#definitions-and-framing">Definitions and Framing</a></li>
  <li><a href="#descending-into-ml">Descending into ML</a></li>
  <li><a href="#reducing-loss">Reducing Loss</a></li>
  <li><a href="#first-steps-with-tensorflow">First steps with TensorFlow</a>
    <ul>
      <li><a href="#tfestimator-api">tf.estimator API</a></li>
    </ul>
  </li>
</ul>
            </nav>
          </aside>
        
        <h2 id="definitions-and-framing">Definitions and Framing</h2>

<ul>
  <li>
    <p><strong>Supervised Machine Learning:</strong></p>

    <p>Using known data to generate some useful predictions of on unseen data</p>

    <p>Label $y$: The target variable that we are trying to predict, for example ‘spam’ or ‘not spam’.</p>

    <p>Features: Something about the data that is used to represent the data, that is later fed into a model. Complicated machine learning models can have multiple features $x_1, x_2, \ldots, x_n$. So this is a vector $\mathbf{x}$.</p>

    <p>Model: Maps unseen data to predictions of label $y$. It is defined by internal parameters that are learned using a training set of labeled data</p>

    <p>Labeled data can be represented as $(\mathbf{x}, y)$. In unlabeled data, $y$ is not known and is predicted by the model.</p>
  </li>
  <li>
    <p><strong>Models</strong></p>

    <p>A model defines the relationship between the features and the label. There are two key phases in the life of a model: <br /></p>

    <p>Training: The phase where you the model is trained or learned. You show the model a number of examples of labeled data, and allow the model to learn the relationship between the features and the label. In other words, it is learning the values of the parameters in the model. These parameters in the model are often called hyperparameters.</p>

    <p>Inference: The phase where the model is used to generate labels $y’$ given features $\mathbf{x}$.</p>
  </li>
  <li>
    <p><strong>Regression vs. Classification</strong></p>

    <p>A regression predicts continuous values while a classification predicts discrete values.</p>
  </li>
</ul>

<h2 id="descending-into-ml">Descending into ML</h2>

<p>Topics covered: Linear Regression, Training and Loss</p>

<ul>
  <li>The $L_2$ loss is defined as</li>
</ul>

<script type="math/tex; mode=display">\begin{align}
L_2 \textrm{ Loss } = \sum\limits_i (y_i - prediction_i(\mathbf{x}))^2 
\end{align}</script>

<p>where we sum over all data points in the training set $i$.</p>

<ul>
  <li>
    <p>The convention in machine learning is to represent the linear model as $y’ = w_1 x_1 + b$ instead of the more traditional $y = mx + b$. We could easily generalize this regression from one feature to multiple features and the prediction would be given by $y’ = w_1 x_1 + w_2 x_2 + w_3 x_3 + b$, where all the $w_i$’s are weights and all the $x_i$’s are features. The process of fitting the model is called training and the process of using the trained model to make a prediction is called inference.</p>
  </li>
  <li>
    <p>A commonly used loss function is the mean squared error (MSE), but this is neither the only loss function nor the best or most practical loss function for all cases.</p>
  </li>
</ul>

<h2 id="reducing-loss">Reducing Loss</h2>

<ul>
  <li>
    <p>One of the popular ways to find the minimum in the loss function is to use Gradient Descent. We calculate a gradient at each point and move in the direction of decreasing gradient. The step size that we use as we advance in the direction of decreasing gradient is called the learning rate. This has to be chosen carefully: in multi-dimensional problems, too large a learning rate can cause the code to become unstable.</p>
  </li>
  <li>
    <p>We can also get trapped in local minima if the space is <em>not-convex</em>. There is a whole sprawling field of non-convex optimization.</p>
  </li>
  <li>
    <p>There are two important flavors of gradient descent:</p>

    <p><strong>Stochastic Gradient Descent:</strong></p>

    <p>In theory, while using gradient descent, we need to calculate the gradient of the loss function considering all examples. However in practice, this is found to be excessive and computationally expensive. We therefore select only one example at random and calculate the gradient of the loss function considering only that one example. This is called stochastic gradient descent. Although this might require more steps to reach the optimum, overall there is usually less computation when dealing with very large data sets. Gradient calculations can be very expensive.</p>

    <p>Mathematically, we want to calculate</p>

    <script type="math/tex; mode=display">\begin{align}
  w_{n+1} = w_n -\eta Q(w)
  \end{align}</script>

    <p>where $\eta$ is the learning rate and $Q(w) = \frac{1}{N}\sum_i Q_i(w)$ is the $L_2$ loss for the $i$-th example. What we do instead, in stochastic gradient descent is to first randomnly pick a particular example $k$ and calculate the loss function $Q_k(w)$ and then update $w$ using:</p>

    <script type="math/tex; mode=display">\begin{align}
  w_{n+1} = w_n -\eta Q_k(w)
  \end{align}</script>

    <p>and perform this iteratively until the minimum criterion is reached.</p>

    <p>When there are multiple parameters to optimize, the gradient is of course a vector, and so is $\mathbf{w} = (w_1, w_2, \ldots)$ and we proceed in the direction of steepest gradient in steps $\eta$ large.</p>

    <p><strong>Mini-batch Gradient Descent</strong></p>

    <p>This is very similar to stochastic gradient descent except that instead of taking only one data point, we take batches of 10 or 100 of them.  Especially with datasets that contain duplicates, enormous datasets do not contain any further information than very large datasets. Mini-batch gradient descent exploits this fact and works very well in practice. Typical values of batch-size range between 10 and 1000. Stochastic gradient descent is an extreme example of mini-batch gradient descent with batch size 1.</p>
  </li>
  <li>
    <p>The algorithm to train the model in this case is iterative: we start with some intial guesses for the parameters, compute the loss function for those values, update the values of the parameters through some scheme (with the goal of moving in the direction of lower loss), calculate the loss for the updated values of the parameters, and proceed iteratively until we achieve convergence. Convergence is usually assumed when the loss becomes below some threshold value, or if the loss function starts changing extremely slowly.</p>
  </li>
</ul>

<h2 id="first-steps-with-tensorflow">First steps with TensorFlow</h2>

<ul>
  <li>
    <p>TensnsorFlow is a computational framework that allows you to build machine learning models. We can use both lower level APIs by defining models based on a series of mathematical operations or we could use predefined higher level APIs such as <code class="highlighter-rouge">tf.estimator</code>. These architectures can be linear regressors or neural networks.</p>
  </li>
  <li>
    <p>TensorFlow consists of the following two components:</p>

    <ol>
      <li>A graph protocol buffer</li>
      <li>A runtime that executes the distributed graph</li>
    </ol>
  </li>
  <li>
    <p>The <strong>graph protocol buffer</strong> or protobuf takes data structures written in a text file and then generates classes in Python (or other language) that allows you to load, save and interact with the data in a user friendly way. In this sense the protobuf and the runtime are akin to Python code and a Python interpreter.</p>
  </li>
  <li>
    <p>Because TensorFlow is built using APIs of various levels of abstraction, we have a choice of level. In general, I should chose the layer that offers the highest level of abstraction. Of course, the highest layers are also less flexible, so for some special modeling cases if I need more flexibility, I can just drop one run lower in the level of API.</p>
  </li>
</ul>

<h3 id="tfestimator-api"><code class="highlighter-rouge">tf.estimator</code> API</h3>

<ul>
  <li>
    <p>The <code class="highlighter-rouge">tf.estimator</code> API is one of the highest level APIs that has a lot of prepackaged tools of use. Below we show some code to exemplify its use. In the example below, we are going to estimate the median housing pricebased on just one input feature. The data is from the 1990 California housing census data. Available <a href="https://developers.google.com/machine-learning/crash-course/california-housing-data-description">here</a></p>

    <p>First we perform some imports</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------

ModuleNotFoundError                       Traceback (most recent call last)

&lt;ipython-input-2-719382ac702b&gt; in &lt;module&gt;
      6 import pandas as pd
      7 from sklearn import metrics
----&gt; 8 import tensorflow as tf


ModuleNotFoundError: No module named 'tensorflow'
</code></pre></div></div>

<p>We next load the data let us load the data</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">california_housing_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://download.mlcc.google.com/mledu-datasets/california_housing_train.csv'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">','</span><span class="p">)</span>

<span class="n">california_housing_dataframe</span> <span class="o">=</span> <span class="n">california_housing_dataframe</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">california_housing_dataframe</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="n">california_housing_dataframe</span><span class="p">[</span><span class="s">'median_house_value'</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">1000</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">california_housing_dataframe</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11838</th>
      <td>-121.34</td>
      <td>38.65</td>
      <td>27.0</td>
      <td>1595.0</td>
      <td>246.0</td>
      <td>610.0</td>
      <td>253.0</td>
      <td>4.6000</td>
      <td>199.0</td>
    </tr>
    <tr>
      <th>15723</th>
      <td>-122.40</td>
      <td>38.34</td>
      <td>33.0</td>
      <td>1408.0</td>
      <td>273.0</td>
      <td>520.0</td>
      <td>212.0</td>
      <td>3.5781</td>
      <td>242.5</td>
    </tr>
    <tr>
      <th>7910</th>
      <td>-118.40</td>
      <td>33.96</td>
      <td>44.0</td>
      <td>1877.0</td>
      <td>314.0</td>
      <td>877.0</td>
      <td>320.0</td>
      <td>6.8197</td>
      <td>363.6</td>
    </tr>
    <tr>
      <th>9977</th>
      <td>-119.76</td>
      <td>34.44</td>
      <td>28.0</td>
      <td>1985.0</td>
      <td>582.0</td>
      <td>1092.0</td>
      <td>548.0</td>
      <td>2.4701</td>
      <td>290.9</td>
    </tr>
    <tr>
      <th>1880</th>
      <td>-117.28</td>
      <td>34.06</td>
      <td>2.0</td>
      <td>1658.0</td>
      <td>290.0</td>
      <td>868.0</td>
      <td>304.0</td>
      <td>5.1365</td>
      <td>136.7</td>
    </tr>
  </tbody>
</table>
</div>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-02-01T00:00:00-05:00">February 01, 2019</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/coursenotes/probability/" class="pagination--pager" title="Probability: The Science and Uncertainty of Data (6.431x)
">Previous</a>
    
    
      <a href="/coursenotes/CFDpython/" class="pagination--pager" title="Computational Fluid Dynamics Python (CFD) - Python
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Aditya Jaishankar. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.6.0/js/all.js" integrity="sha384-z9ZOvGHHo21RqN5De4rfJMoAxYpaVoiYhuJXPyVmSs8yn20IE3PmBM534CffwSJI" crossorigin="anonymous"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>








<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
processEscapes: true},
jax: ["input/TeX","input/MathML","input/AsciiMath","output/CommonHTML"],
extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","AssistiveMML.js", "[Contrib]/a11y/accessibility-menu.js"],
TeX: {
extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"],
equationNumbers: {
autoNumber: "AMS"
}
}
});
</script>


  </body>
</html>
