<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Mushroom Toxicity Prediction  | Aditya Jaishankar</title>
<meta name="description" content="Mushrooms: to eat or not to eat?">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Aditya Jaishankar">
<meta property="og:title" content="Mushroom Toxicity Prediction">
<meta property="og:url" content="http://localhost:4000/projects/mushroomproject/">


  <meta property="og:description" content="Mushrooms: to eat or not to eat?">







  <meta property="article:published_time" content="2019-12-20T21:51:21-05:00">





  

  


<link rel="canonical" href="http://localhost:4000/projects/mushroomproject/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Aditya Jaishankar",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Aditya Jaishankar Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->







<link href="https://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet">





<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/"> </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/coursework/" >ML/AI Coursework</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/" >Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/research/" >Ph.D. Research</a>
            </li><li class="masthead__menu-item">
              <a href="/publications/" >Publications</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/projects" itemprop="item"><span itemprop="name">Projects</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Mushroom Toxicity Prediction </li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/profile.jpg" alt="Aditya Jaishankar" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Aditya Jaishankar</h3>
    
    
      <p class="author__bio" itemprop="description">
        <b>Ph.D., Massachusetts Institute of Technology.</b><br>Soft Condensed Matter Physicist and Surface Scientist.
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">New Jersey, USA</span>
        </li>
      

      
        
          
        
          
            <li><a href="https://www.github.com/aditya-jaishankar/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/adityajaishankar" rel="nofollow noopener noreferrer"><i class="fab fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
          
        
          
            <li><a href="/assets/misc/Resume_Jaishankar_191020.pdf" rel="nofollow noopener noreferrer"><i class="fas fa-file-alt" aria-hidden="true"></i> Resume</a></li>
          
        
      

      

      
        <li>
          <a href="mailto:aditya1642@gmail.com">
            <meta itemprop="email" content="aditya1642@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Mushroom Toxicity Prediction">
    <meta itemprop="description" content="Mushrooms: to eat or not to eat?">
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Mushroom Toxicity Prediction
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h1 id="mushrooms-to-eat-or-not-to-eat">Mushrooms: to eat or not to eat?</h1>

<p>I love mushrooms. I also love hiking. Often, I see various types of mushrooms on strewn around the forest floor. The diversity of the different kinds of mushrooms I see is truly staggering. The type of mushroom depends on geography of course: which part of the country or the world am I in? It can also be seasonal. I have done the same hike in summer and winter, and notices that the types and numbers of mushrooms have changed. On the same hike in the same season, I also see different mushrooms depending on altitude. All this diversity notwithstanding, I am most interested in the question: Can I eat it?</p>

<p>Here I answer this question.</p>

<p><strong>Note: This project was done for educational purposes. Before eating any kind of wild and unknown mushroom, please check if it is safe to eat with experts or sources more authoritative than this project (such as textbooks).</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div></div>

<h2 id="feature-name-cleaning-and-wrangling">Feature name cleaning and wrangling</h2>

<p>The data source contains a list of property types, property names, and symbols. As I will show below, this data will prove critical to understanding the results of the analysis. We therefore need to save and digest this data in a useable form. The properties were saved as a text file and loaded into the notebook using <code class="highlighter-rouge">pd.read_fwf()</code> into a <code class="highlighter-rouge">pandas</code> dataframe as shown below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">prop_legend</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="s">'props_legend.txt'</span><span class="p">)</span>
<span class="n">prop_legend</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Attribute Information: (classes: edible=e, poisonous=p)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>- cap-shape: bell=b,conical=c,convex=x,flat=f,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>- cap-surface: fibrous=f,grooves=g,scaly=y,smo...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>- cap-color: brown=n,buff=b,cinnamon=c,gray=g,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>- bruises: bruises=t,no=f</td>
    </tr>
    <tr>
      <th>4</th>
      <td>- odor: almond=a,anise=l,creosote=c,fishy=y,fo...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>- gill-attachment: attached=a,descending=d,fre...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>- gill-spacing: close=c,crowded=w,distant=d</td>
    </tr>
    <tr>
      <th>7</th>
      <td>- gill-size: broad=b,narrow=n</td>
    </tr>
    <tr>
      <th>8</th>
      <td>- gill-color: black=k,brown=n,buff=b,chocolate...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>- stalk-shape: enlarging=e,tapering=t</td>
    </tr>
    <tr>
      <th>10</th>
      <td>- stalk-root: bulbous=b,club=c,cup=u,equal=e,r...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>- stalk-surface-above-ring: fibrous=f,scaly=y,...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>- stalk-surface-below-ring: fibrous=f,scaly=y,...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>- stalk-color-above-ring: brown=n,buff=b,cinna...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>- stalk-color-below-ring: brown=n,buff=b,cinna...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>- veil-type: partial=p,universal=u</td>
    </tr>
    <tr>
      <th>16</th>
      <td>- veil-color: brown=n,orange=o,white=w,yellow=y</td>
    </tr>
    <tr>
      <th>17</th>
      <td>- ring-number: none=n,one=o,two=t</td>
    </tr>
    <tr>
      <th>18</th>
      <td>- ring-type: cobwebby=c,evanescent=e,flaring=f...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>- spore-print-color: black=k,brown=n,buff=b,ch...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>- population: abundant=a,clustered=c,numerous=...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>- habitat: grasses=g,leaves=l,meadows=m,paths=...</td>
    </tr>
  </tbody>
</table>
</div>

<p>Clearly, this table needs a lot of work to digest and convert to a format that can be used in further analysis. The ultimate goal of importing this data is to create a ‘look up dictionary’ mapping the feature symbol to a feature name that would help with, for example plotting, and visualizing the data to add more meaning and understanding to the analysis. The following pieces of code clean digest the data</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Cleaning and wrangling the text file</span>

<span class="n">prop_legend</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="s">'props_legend.txt'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">prop_legend</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">prop_legend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>We now want to move the property names over as the index names. Examples of the property names are cap-shape, odor, ring-type, veil-color, etc. For this we extract the property names using regular expressions (implemented in python using the <code class="highlighter-rouge">re</code> package.) Documentation available here: https://docs.python.org/3.4/library/re.html</p>

<p>We first extract these property names into a data series to set as index names in the data frame</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">property_extractor</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
    <span class="s">"""input: takes in the mushroom property with all the keys.
       output: returns the property name only
       
       The function uses regular expressions to only select words that end in a colon 
    """</span>
    <span class="n">re_matcher</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'[a-z-]+:'</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">re_matcher</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">property_list</span> <span class="o">=</span> <span class="n">prop_legend</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">property_extractor</span><span class="p">)</span>
<span class="n">prop_legend</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">property_list</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">prop_legend</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'property type'</span>
</code></pre></div></div>

<p>Now we replace the property name with an empty string and do some further clean up</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">string_replacer</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'[a-z-]+:'</span><span class="p">,</span><span class="s">''</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>

<span class="n">prop_legend</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop_legend</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">string_replacer</span><span class="p">)</span>
<span class="n">prop_legend</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">prop_legend</span><span class="o">.</span><span class="n">set_axis</span><span class="p">([</span><span class="s">'property names'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">prop_legend</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>property names</th>
    </tr>
    <tr>
      <th>property type</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cap-shape</th>
      <td>bell=b,conical=c,convex=x,flat=f, knobbed=k,s...</td>
    </tr>
    <tr>
      <th>cap-surface</th>
      <td>fibrous=f,grooves=g,scaly=y,smooth=s</td>
    </tr>
    <tr>
      <th>cap-color</th>
      <td>brown=n,buff=b,cinnamon=c,gray=g,green=r,pink...</td>
    </tr>
    <tr>
      <th>bruises</th>
      <td>bruises=t,no=f</td>
    </tr>
    <tr>
      <th>odor</th>
      <td>almond=a,anise=l,creosote=c,fishy=y,foul=f,mu...</td>
    </tr>
  </tbody>
</table>
</div>

<p>We now convert the property names into a dictionary so that we can refer to them using a key value format. Examples of property names are (bell, convex, flat, etc.) for the property type cap-shape.</p>

<p>We again use regular expressions for this. We write the function below:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">dict_converter</span><span class="p">(</span><span class="n">ser</span><span class="p">):</span>
    <span class="s">""" input: one row of the dataframe
        output: converts the row into a dictionary of the form {symbol:name} 
        for easy lookup later
    """</span>
    
    <span class="n">re_matcher_names</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'[a-z]+='</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">re_matcher_names</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">ser</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">))</span>
    
    <span class="n">re_matcher_symbols</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'=[a-z]'</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re_matcher_symbols</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">ser</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">))</span>

    <span class="n">pairs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">names</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">symbol</span><span class="p">:</span> <span class="n">name</span>  <span class="k">for</span> <span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">}</span>

<span class="n">prop_legend</span> <span class="o">=</span> <span class="n">prop_legend</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">dict_converter</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">prop_legend</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">prop_legend</span><span class="p">)</span>
<span class="n">prop_legend</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
    <tr>
      <th>property type</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cap-shape</th>
      <td>{'b': 'bell', 'c': 'conical', 'x': 'convex', '...</td>
    </tr>
    <tr>
      <th>cap-surface</th>
      <td>{'f': 'fibrous', 'g': 'grooves', 'y': 'scaly',...</td>
    </tr>
    <tr>
      <th>cap-color</th>
      <td>{'n': 'brown', 'b': 'buff', 'c': 'cinnamon', '...</td>
    </tr>
    <tr>
      <th>bruises</th>
      <td>{'t': 'bruises', 'f': 'no'}</td>
    </tr>
    <tr>
      <th>odor</th>
      <td>{'a': 'almond', 'l': 'anise', 'c': 'creosote',...</td>
    </tr>
  </tbody>
</table>
</div>

<p>We now have a data frame of the property names with all values as dictionary which we can use for easy look up while visualizing the data and interpreting the results.</p>

<h2 id="loading--and-inspecting-the-data">Loading  and inspecting the data</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'mushrooms.csv'</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>cap-shape</th>
      <th>cap-surface</th>
      <th>cap-color</th>
      <th>bruises</th>
      <th>odor</th>
      <th>gill-attachment</th>
      <th>gill-spacing</th>
      <th>gill-size</th>
      <th>gill-color</th>
      <th>...</th>
      <th>stalk-surface-below-ring</th>
      <th>stalk-color-above-ring</th>
      <th>stalk-color-below-ring</th>
      <th>veil-type</th>
      <th>veil-color</th>
      <th>ring-number</th>
      <th>ring-type</th>
      <th>spore-print-color</th>
      <th>population</th>
      <th>habitat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>p</td>
      <td>x</td>
      <td>s</td>
      <td>n</td>
      <td>t</td>
      <td>p</td>
      <td>f</td>
      <td>c</td>
      <td>n</td>
      <td>k</td>
      <td>...</td>
      <td>s</td>
      <td>w</td>
      <td>w</td>
      <td>p</td>
      <td>w</td>
      <td>o</td>
      <td>p</td>
      <td>k</td>
      <td>s</td>
      <td>u</td>
    </tr>
    <tr>
      <th>1</th>
      <td>e</td>
      <td>x</td>
      <td>s</td>
      <td>y</td>
      <td>t</td>
      <td>a</td>
      <td>f</td>
      <td>c</td>
      <td>b</td>
      <td>k</td>
      <td>...</td>
      <td>s</td>
      <td>w</td>
      <td>w</td>
      <td>p</td>
      <td>w</td>
      <td>o</td>
      <td>p</td>
      <td>n</td>
      <td>n</td>
      <td>g</td>
    </tr>
    <tr>
      <th>2</th>
      <td>e</td>
      <td>b</td>
      <td>s</td>
      <td>w</td>
      <td>t</td>
      <td>l</td>
      <td>f</td>
      <td>c</td>
      <td>b</td>
      <td>n</td>
      <td>...</td>
      <td>s</td>
      <td>w</td>
      <td>w</td>
      <td>p</td>
      <td>w</td>
      <td>o</td>
      <td>p</td>
      <td>n</td>
      <td>n</td>
      <td>m</td>
    </tr>
    <tr>
      <th>3</th>
      <td>p</td>
      <td>x</td>
      <td>y</td>
      <td>w</td>
      <td>t</td>
      <td>p</td>
      <td>f</td>
      <td>c</td>
      <td>n</td>
      <td>n</td>
      <td>...</td>
      <td>s</td>
      <td>w</td>
      <td>w</td>
      <td>p</td>
      <td>w</td>
      <td>o</td>
      <td>p</td>
      <td>k</td>
      <td>s</td>
      <td>u</td>
    </tr>
    <tr>
      <th>4</th>
      <td>e</td>
      <td>x</td>
      <td>s</td>
      <td>g</td>
      <td>f</td>
      <td>n</td>
      <td>f</td>
      <td>w</td>
      <td>b</td>
      <td>k</td>
      <td>...</td>
      <td>s</td>
      <td>w</td>
      <td>w</td>
      <td>p</td>
      <td>w</td>
      <td>o</td>
      <td>e</td>
      <td>n</td>
      <td>a</td>
      <td>g</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div>

<p>Let us first check if the dataset is of a reasonable size to be able to do adequaete statistical analysis. We describe the data set to get a feel for the dataset</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>class</th>
      <td>8124</td>
      <td>2</td>
      <td>e</td>
      <td>4208</td>
    </tr>
    <tr>
      <th>cap-shape</th>
      <td>8124</td>
      <td>6</td>
      <td>x</td>
      <td>3656</td>
    </tr>
    <tr>
      <th>cap-surface</th>
      <td>8124</td>
      <td>4</td>
      <td>y</td>
      <td>3244</td>
    </tr>
    <tr>
      <th>cap-color</th>
      <td>8124</td>
      <td>10</td>
      <td>n</td>
      <td>2284</td>
    </tr>
    <tr>
      <th>bruises</th>
      <td>8124</td>
      <td>2</td>
      <td>f</td>
      <td>4748</td>
    </tr>
    <tr>
      <th>odor</th>
      <td>8124</td>
      <td>9</td>
      <td>n</td>
      <td>3528</td>
    </tr>
    <tr>
      <th>gill-attachment</th>
      <td>8124</td>
      <td>2</td>
      <td>f</td>
      <td>7914</td>
    </tr>
    <tr>
      <th>gill-spacing</th>
      <td>8124</td>
      <td>2</td>
      <td>c</td>
      <td>6812</td>
    </tr>
    <tr>
      <th>gill-size</th>
      <td>8124</td>
      <td>2</td>
      <td>b</td>
      <td>5612</td>
    </tr>
    <tr>
      <th>gill-color</th>
      <td>8124</td>
      <td>12</td>
      <td>b</td>
      <td>1728</td>
    </tr>
    <tr>
      <th>stalk-shape</th>
      <td>8124</td>
      <td>2</td>
      <td>t</td>
      <td>4608</td>
    </tr>
    <tr>
      <th>stalk-root</th>
      <td>8124</td>
      <td>5</td>
      <td>b</td>
      <td>3776</td>
    </tr>
    <tr>
      <th>stalk-surface-above-ring</th>
      <td>8124</td>
      <td>4</td>
      <td>s</td>
      <td>5176</td>
    </tr>
    <tr>
      <th>stalk-surface-below-ring</th>
      <td>8124</td>
      <td>4</td>
      <td>s</td>
      <td>4936</td>
    </tr>
    <tr>
      <th>stalk-color-above-ring</th>
      <td>8124</td>
      <td>9</td>
      <td>w</td>
      <td>4464</td>
    </tr>
    <tr>
      <th>stalk-color-below-ring</th>
      <td>8124</td>
      <td>9</td>
      <td>w</td>
      <td>4384</td>
    </tr>
    <tr>
      <th>veil-type</th>
      <td>8124</td>
      <td>1</td>
      <td>p</td>
      <td>8124</td>
    </tr>
    <tr>
      <th>veil-color</th>
      <td>8124</td>
      <td>4</td>
      <td>w</td>
      <td>7924</td>
    </tr>
    <tr>
      <th>ring-number</th>
      <td>8124</td>
      <td>3</td>
      <td>o</td>
      <td>7488</td>
    </tr>
    <tr>
      <th>ring-type</th>
      <td>8124</td>
      <td>5</td>
      <td>p</td>
      <td>3968</td>
    </tr>
    <tr>
      <th>spore-print-color</th>
      <td>8124</td>
      <td>9</td>
      <td>w</td>
      <td>2388</td>
    </tr>
    <tr>
      <th>population</th>
      <td>8124</td>
      <td>6</td>
      <td>v</td>
      <td>4040</td>
    </tr>
    <tr>
      <th>habitat</th>
      <td>8124</td>
      <td>7</td>
      <td>d</td>
      <td>3148</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 8124 entries, 0 to 8123
Data columns (total 23 columns):
class                       8124 non-null object
cap-shape                   8124 non-null object
cap-surface                 8124 non-null object
cap-color                   8124 non-null object
bruises                     8124 non-null object
odor                        8124 non-null object
gill-attachment             8124 non-null object
gill-spacing                8124 non-null object
gill-size                   8124 non-null object
gill-color                  8124 non-null object
stalk-shape                 8124 non-null object
stalk-root                  8124 non-null object
stalk-surface-above-ring    8124 non-null object
stalk-surface-below-ring    8124 non-null object
stalk-color-above-ring      8124 non-null object
stalk-color-below-ring      8124 non-null object
veil-type                   8124 non-null object
veil-color                  8124 non-null object
ring-number                 8124 non-null object
ring-type                   8124 non-null object
spore-print-color           8124 non-null object
population                  8124 non-null object
habitat                     8124 non-null object
dtypes: object(23)
memory usage: 1.4+ MB
</code></pre></div></div>

<p>Everything looks good so far. It seems that there are no null values in the data and the data is already relatively clean. However, While exploring the data, I noticed a problem with the stalk-root column. Instead of NaN, the data set contains ‘?’ instead, which could be treated as a symbolic parameter in the rest of my analysis, and that would be a problem because it would confuse the machine learning algorithm.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check to see if '?' appears in the stalk-root column</span>
<span class="k">print</span><span class="p">(</span><span class="s">'?'</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">'stalk-root'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="c"># let us see how many appearances of '?' exist to see how bad the problem is</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">'stalk-root'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>True





{'e': 1120, 'c': 556, 'b': 3776, 'r': 192, '?': 2480}
</code></pre></div></div>

<p>There are a huge number of ‘?’ symbols! It seems like instead of using NaNs, they have used a ‘?’. They might have used this in other columns and hence we will check to see if this is true.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qmark</span> <span class="o">=</span> <span class="p">[(</span><span class="n">column</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">])))</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="c"># Check if '?' exists in the key of any of the symbol dictionaries</span>
<span class="n">qmark_bool</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">'?'</span> <span class="ow">in</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">qmark</span><span class="p">)</span> 
<span class="k">print</span><span class="p">([</span><span class="n">tup</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">qmark_bool</span> <span class="k">if</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="c"># only print the tuple if '?' in keys</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[('stalk-root', True)]
</code></pre></div></div>

<p>From this we see that only the stalk-root column contains a ‘?’ and given that we have many features in the data set, we will drop the stalk-root column and not use it in our analysis moving forward.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'stalk-root'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="data-visualization">Data visualization</h2>

<p>To get a feel for the data and understand what we are looking at, plotting and visualizing data helps greatly. Because this data set is entirely categorical, we are limited in the types of plotting we can do. One useful outcome of the plotting exercise is to see which features differ the most between the edible mushrooms and poisonous mushrooms. For example, are many of the edible mushrooms pleasant smelling and many of the poisonous mushrooms foul smelling? Building this kind of intuition will help us along the way in our analysis, and also to see if the results of any predictive analysis makes sense.</p>

<p>Below we plot histograms of each property type and compare if there are any particular properties where the different between edible and poisonous mushrooms is very large.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'axes'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'xtick'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'ytick'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span> 
                        <span class="n">constrained_layout</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">3</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span>
    <span class="n">ax_curr</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="s">'class'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_curr</span><span class="p">)</span>
    <span class="n">ax_curr</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'poisonous'</span><span class="p">,</span> <span class="s">'edible'</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s">'upper right'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">ax_curr</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Counts'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax_curr</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>
    <span class="p">(</span><span class="n">ax_curr</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">prop_legend</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">val</span><span class="p">]</span> 
                              <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]))</span>
</code></pre></div></div>

<p><img src="/assets/images/projects/mushroomproject/output_27_0.png" alt="png" /></p>

<p>A number of different features stand out from this analysis. We see that a lot of edible mushrooms have no odor while a lot of poisonous mushrooms have a foul odor. So we would expect this feature to play a major role in determining if a mushroom is edible or not. Similarly, other features that stand out are gill-size, gill-color, and ring-type. Armed with this intuition, we will begin a more detailed predictive analysis.</p>

<h2 id="naive-bayes-classifier">Naive Bayes Classifier</h2>

<p>Our goal to be able to predict if a mushroom is edible or poisonous given it’s properties. Because the data is categorical and symbolic, a Naive Bayes classifier is well suited for this task. We will use the Naive Bayes Classifier in the <code class="highlighter-rouge">nltk</code> package to make predictions on whether a mushroom is likely to be poisonous or edible. For this we will need to convert the data into the following format:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    class                           feature_dictionary
0     e     {'cap-shape': 'x', 'cap-surface': f, 'cap-color': 'n', ...}
1     p     {'cap-shape': 'x', 'cap-surface': y, 'cap-color': 'w', ...}
</code></pre></div></div>

<p>In this format, we can then supply these features to the Naive Bayes Classifier and make predictions. We will now write a function to do this.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">feature_dictionary_creator</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="s">"""
        input: takes in a row of the data dataframe
        returns: a series that has the format: 
            'class': 'x'
            'feature_dictionary': '{... ... ... ...}'
        the ultimate goal is to create a new dataframe with class as one
        column and feature dictionary as another column to feed to the 
        Naive Bayes Classifier
    """</span>
    
    <span class="c"># We omit the class column. We will add it in</span>
    <span class="c"># later as the second element of a tuple </span>
    <span class="n">prop_names</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  
    <span class="n">prop_values</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tuples</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">prop_names</span><span class="p">,</span> <span class="n">prop_values</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">({</span><span class="n">name</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">},</span> <span class="n">label</span><span class="p">)</span>
</code></pre></div></div>

<p>We now use a for loop to iterate through the dataframe and add a column called featureset that contains the output of <code class="highlighter-rouge">feature_dictionary_creator</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">featuresets</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">feature_dictionary_creator</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s">'featuresets'</span><span class="p">]</span> <span class="o">=</span> <span class="n">featuresets</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">all_features</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'featuresets'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">all_features</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>8124
</code></pre></div></div>

<p>We are now ready to use the mushroom features to input into the naive bayes classifier. We first split the dataset into a training set and a test set. We use 80% of the data as the train set and the remaining as the test set. Because the total size of the dataset is 8124 rows, we will use 6500 rows as the training set. We then proceed to implement the classifier</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">NaiveBayesClassifier</span> <span class="k">as</span> <span class="n">nbc</span>
<span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span> <span class="o">=</span> <span class="n">all_features</span><span class="p">[:</span><span class="mi">6500</span><span class="p">],</span> <span class="n">all_features</span><span class="p">[</span><span class="mi">6500</span><span class="p">:]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">classify</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">nbc</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">train_set</span><span class="p">)</span>
<span class="n">classify</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">test_set</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.9593596059113301
</code></pre></div></div>

<p>As we see above, we get an accuracy of 95%. However, let us see if we can improve the accuracy further. Let us play with the size of the test set and train set. Let us plot the model accuracy as a function of the ratio of the train set from 20% to 98%. We also shuffle the list to make sure we appropriately randomize the training.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">shuffle</span>

<span class="c"># Go from using 0.1% of the data to 99.9% of the data</span>
<span class="n">ratios</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">.</span><span class="mo">001</span><span class="p">,</span> <span class="o">.</span><span class="mi">999</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">ratio</span> <span class="ow">in</span> <span class="n">ratios</span><span class="p">:</span>
    <span class="n">shuffle</span><span class="p">(</span><span class="n">all_features</span><span class="p">)</span>
    <span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span> <span class="o">=</span> <span class="n">all_features</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="mi">8124</span><span class="o">*</span><span class="n">ratio</span><span class="p">)],</span> <span class="n">all_features</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">8124</span><span class="o">*</span><span class="n">ratio</span><span class="p">):]</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="n">nbc</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">train_set</span><span class="p">)</span>
    <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classify</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">test_set</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Number of rows'</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'accuracy'</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ratios</span><span class="o">*</span><span class="mi">8124</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="n">accuracies</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[&lt;matplotlib.lines.Line2D at 0x1a2106f208&gt;]
</code></pre></div></div>

<p><img src="/assets/images/projects/mushroomproject/output_40_1.png" alt="png" /></p>

<p>We see that the accuracy of prediction is low when we have very few records, but increases quickly to a plateau. Interestingly, if we use too much of the data, the accuracy of the model again begins to drop, probably due to over-fitting effects. In effect, it is not necessary to train the model on more than a few hundred different types of mushrooms.</p>

<p>We next look at the most informative features: if I am going hiking and I spot a mushroom in the wild, which features should I look at first to guess if the mushroom is likely to be edible or not? We go back to using about 6500 rows as the training set for this exercise.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span> <span class="o">=</span> <span class="n">all_features</span><span class="p">[:</span><span class="mi">6500</span><span class="p">],</span> <span class="n">all_features</span><span class="p">[</span><span class="mi">6500</span><span class="p">:]</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">nbc</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">train_set</span><span class="p">)</span>
<span class="n">mif</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">most_informative_features</span><span class="p">()[:</span><span class="mi">12</span><span class="p">]</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">show_most_informative_features</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Most Informative Features
       spore-print-color = 'h'                 p : e      =     34.2 : 1.0
  stalk-color-above-ring = 'n'                 p : e      =     33.9 : 1.0
                    odor = 'n'                 e : p      =     25.7 : 1.0
stalk-surface-above-ring = 'k'                 p : e      =     18.2 : 1.0
stalk-surface-below-ring = 'k'                 p : e      =     16.9 : 1.0
            gill-spacing = 'w'                 e : p      =     10.0 : 1.0
              gill-color = 'u'                 e : p      =      8.6 : 1.0
                 habitat = 'p'                 p : e      =      8.3 : 1.0
               gill-size = 'n'                 p : e      =      8.0 : 1.0
         gill-attachment = 'a'                 e : p      =      8.0 : 1.0
               cap-shape = 'b'                 e : p      =      7.9 : 1.0
              gill-color = 'n'                 e : p      =      7.8 : 1.0
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Converting symbols to actual values based on the props_legend dictionary </span>
<span class="c"># constructed earlier</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[(</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">prop_legend</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">mif</span><span class="p">]</span>
<span class="n">x</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[('spore-print-color', 'chocolate'),
 ('stalk-color-above-ring', 'brown'),
 ('odor', 'none'),
 ('stalk-surface-above-ring', 'silky'),
 ('stalk-surface-below-ring', 'silky'),
 ('gill-spacing', 'crowded'),
 ('gill-color', 'purple'),
 ('habitat', 'paths'),
 ('gill-size', 'narrow'),
 ('gill-attachment', 'attached'),
 ('cap-shape', 'bell'),
 ('gill-color', 'brown')]
</code></pre></div></div>

<p>From this, we see conclude the following:</p>

<p><strong>A mushroom is likely to be poisonous if:</strong></p>
<ul>
  <li>The spore print color is chocolate</li>
  <li>The stalk color above and below the ring is brown</li>
  <li>The stalk surface above and below the ring is silky</li>
  <li>The gill size is narrow</li>
  <li>It is found along paths</li>
</ul>

<p><strong>A mushroom is likely to be edible if:</strong></p>
<ul>
  <li>It has no odor</li>
  <li>It has an attached gill</li>
  <li>The gill spacing is crowded</li>
  <li>The gill color is purple</li>
  <li>The cap is bell shaped</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/projects/cnn-hydrophilicity-from-structures/" class="pagination--pager" title="Molecular solubility from polar charge density images: Main file
">Previous</a>
    
    
      <a href="/projects/neuralpde/" class="pagination--pager" title="Solution of partial differential equations using neural networks
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Aditya Jaishankar. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.6.0/js/all.js" integrity="sha384-z9ZOvGHHo21RqN5De4rfJMoAxYpaVoiYhuJXPyVmSs8yn20IE3PmBM534CffwSJI" crossorigin="anonymous"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>








<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
processEscapes: true},
jax: ["input/TeX","input/MathML","input/AsciiMath","output/CommonHTML"],
extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","AssistiveMML.js", "[Contrib]/a11y/accessibility-menu.js"],
TeX: {
extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"],
equationNumbers: {
autoNumber: "AMS"
}
}
});
</script>


  </body>
</html>
